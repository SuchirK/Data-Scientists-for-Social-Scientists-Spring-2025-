---
title: 'DS 10: Regression in Political Science Using R'
author: "Suchir Kalra"
subtitle: Simple, Multiple, and Multivariate Regression
output: slidy_presentation
---

# üó≥Ô∏è Regression & Voting Behavior

We are going to try to examine the relationship between Literacy Rate & Voter Turnout through:

- Simple Linear Regression
- Multiple Linear Regression
- Multivariate Regression
- Understanding Controls & Coefficients
- Fixed Effects - District & Time


```{r include=FALSE}
library (modelsummary)
library (stargazer)
```

# üîß Simulating Political Science Data in R (This creates a random dataset! Don't trust this data! It's self created)

```{r making a random dataset, message=FALSE, warning=FALSE}


set.seed(123)

# Simulate panel data: 10 districts over 5 years
districts <- paste0("D", 1:10)
years <- 2015:2019
panel_data <- expand.grid(district = districts, year = years)

# Add variables
panel_data$literacy_rate <- round(runif(nrow(panel_data), 60, 95), 1)
panel_data$urbanization <- round(runif(nrow(panel_data), 30, 90), 1)
panel_data$median_income <- round(rnorm(nrow(panel_data), 50000, 10000), 0)
panel_data$internet_access <- round(runif(nrow(panel_data), 20, 80), 1)

# Generate outcome with district and year effects
district_effects <- rnorm(length(districts), 0, 5)
names(district_effects) <- districts

year_effects <- rnorm(length(years), 0, 2)
names(year_effects) <- years

panel_data$voter_turnout <- 40 +
  0.2 * panel_data$literacy_rate +
  0.05 * panel_data$internet_access +
  district_effects[panel_data$district] +
  year_effects[as.character(panel_data$year)] +
  rnorm(nrow(panel_data), 0, 3)

panel_data$partyA_share <- 30 +
  0.3 * panel_data$literacy_rate +        # Party A does well where literacy is higher
  -0.2 * panel_data$urbanization +        # Maybe weaker in urban areas
  0.01 * panel_data$median_income +       # Slightly better in richer districts
  0.1 * panel_data$internet_access +      # More popular in digitally connected areas
  rnorm(nrow(panel_data), mean = 0, sd = 5)  # Add random noise

head(panel_data)

```

## Simple Linear Regression Model 

```{r simple model, echo=TRUE, message=FALSE, warning=FALSE}
model_simple <- lm(voter_turnout ~ literacy_rate, data = panel_data)

print(summary(model_simple))

stargazer(model_simple, report = "vcp", # v = coefficient, c = p-value -- format be adjusted according to how you want to display the regression equation
          p.auto = TRUE, type = "text")
```
## Visualising Simple Regression

```{r visualising simple regression, echo=TRUE, message=FALSE, warning=FALSE}

plot_simple <- plot(panel_data$literacy_rate, panel_data$voter_turnout,
     xlab = "Literacy Rate (%)", ylab = "Voter Turnout (%)",
     main = "Simple Linear Regression")
abline(model_simple, col = "blue", lwd = 2)

```
## Adding Controls to linear regression

```{r adding controls to the linear regression, echo=TRUE, message=FALSE, warning=FALSE}

model_controls <- lm(voter_turnout ~ literacy_rate + urbanization + median_income + internet_access,
                     data = panel_data)

summary(model_controls)$coefficients

```

```{r putting simple regression and with control together, echo=TRUE, message=FALSE, warning=FALSE}

stargazer(model_simple, model_controls, report = "vcp",          
          p.auto = TRUE, type = "text", digits = 6)

```



After controlling for urbanization, income, internet access, the coefficient of literacy drops ‚Äî because part of its apparent effect was confounded.

What happens to the R2 Score? 

R¬≤ will always increase when you add more variables ‚Äî but that doesn‚Äôt always mean your model is better. That‚Äôs why we check Adjusted R¬≤ too. Good for understanding overall model fit but can be inflated by adding more variables, regardless of their true impact.


## Multivariate Regression

This fits two separate linear models internally: voter_turnout ~ literacy_rate + ... & partyA_share ~ literacy_rate + ...

```{r multivariate regression, echo=TRUE, message=FALSE, warning=FALSE}

Y <- cbind(panel_data$voter_turnout, panel_data$partyA_share)
X <- as.matrix(panel_data[, c("literacy_rate", "urbanization", "median_income", "internet_access")])

model_multi <- lm(Y ~ X)

summary(model_multi)

```
If your outcomes are correlated (e.g., turnout & vote share), modeling them together gives you more accurate standard errors. Multivariate regression allows us to model multiple outcomes jointly. This is useful when the same factors affect more than one political outcome ‚Äî for instance, literacy may influence both turnout and vote share.

# üß± Why District and Year Fixed Effects?

### ‚úÖ District Fixed Effects

Districts differ in many **time-invariant** ways that may affect voter turnout:

- Historical political culture
- Local party strength
- Literacy history
- Urban/rural composition
- Caste/class balance

We may not observe all of these factors directly. But if they **don‚Äôt change much over time**, we can **control for them** using _district fixed effects_.

This helps isolate the effect of variables like literacy or internet access **within each district over time**.

### üïí Year Fixed Effects

Election years bring **common national shocks**:

- National party wave (e.g., Modi wave in 2014)
- Economic events (e.g., demonetization)
- Election Commission policies
- COVID-related disruptions

Year fixed effects soak up **anything that affects all districts equally in a given year**, so we don't mistakenly attribute it to our variables of interest.

### üß™ Together: District + Year FE

By including **both**, our model asks:

> "Within a given district, when literacy or internet access increases, does turnout change ‚Äî accounting for anything constant about that district and anything affecting all districts that year?"


```{r adding fixed effects 1, echo=TRUE, message=FALSE, warning=FALSE}
library(lfe)

# No fixed effects
model_felm_simple <- felm(voter_turnout ~ literacy_rate + internet_access | 0, data = panel_data)

stargazer(model_felm_simple, report = "vcp",          # v = coefficient, c = p-value, p = significance stars
          p.auto = TRUE, type = "text")
```


```{r adding fixed effects 2, echo=TRUE, message=FALSE, warning=FALSE}
# District fixed effects
model_felm_district <- felm(voter_turnout ~ literacy_rate + internet_access | district, data = panel_data)

stargazer(model_felm_district, report = "vcp",          # v = coefficient, c = p-value, p = significance stars
          p.auto = TRUE, type = "text")
```
```{r adding fixed effects 3, echo=TRUE, message=FALSE, warning=FALSE}
#Year fixed effects
model_felm_year <- felm(voter_turnout ~ literacy_rate + internet_access | year, data = panel_data)

stargazer(model_felm_year, report = "vcp",          # v = coefficient, c = p-value, p = significance stars
          p.auto = TRUE, type = "text")
```


```{r adding fixed effects 4, echo=TRUE, message=FALSE, warning=FALSE}

# District + year fixed effects
model_felm_district_year <- felm(voter_turnout ~ literacy_rate + internet_access | district + year, data = panel_data)

stargazer(model_felm_district_year, report = "vcp",          # v = coefficient, c = p-value, p = significance stars
          p.auto = TRUE, type = "text")
```



```{r with fixed effects 5, echo=TRUE, message=FALSE, warning=FALSE}
stargazer(model_felm_simple,model_felm_district,model_felm_district_year, column.labels = c("simple", "district fixed effects", "district + time fixed effects"), report = "vcp", p.auto = TRUE, type = "text")
```

## Note Stargazer can typically handle 3 models in one table. Hence, we can use model summary library for a broad summary. 

```{r with fixed effects - modelsummary aesthetics, echo=TRUE, message=FALSE, warning=FALSE}
library(modelsummary)

modelsummary(
  list(
    "Simple OLS" = model_felm_simple,
    "District FE" = model_felm_district,
    "Year FE" = model_felm_year,
    "District + Year FE" = model_felm_district_year
  ),
  output = "markdown",   # or "html" for slides
  statistic = "p.value"  # shows p-values instead of SEs
)

```






