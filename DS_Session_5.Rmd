---
title: "DS_Session_5"
author: "Suchir Kalra"
date: "`r Sys.Date()`"
output: html_document
---



```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r reading the datasets and loading libraries, echo=FALSE}
library (tidyverse)
library (ggplot2)
library(knitr)

tcpd_assembly <- read.csv ("All_States_AE.csv") 

tcpd_ge <- read.csv('All_States_GE.csv')
```



```{r over decades,include=FALSE}
tcpd_assembly = tcpd_assembly %>% 
  mutate(decade = case_when(
    Year >= 1960 & Year < 1970 ~ 1,
    Year >= 1970 & Year < 1980 ~ 2,
    Year >= 1980 & Year < 1990 ~ 3,
    Year >= 1990 & Year < 2000 ~ 4,
    Year >= 2000 & Year < 2010 ~ 5,
    Year >= 2010 & Year < 2020 ~ 6,
    Year >= 2020 & Year < 2030 ~ 7,
    TRUE ~ NA_real_
  ))

tcpd_ge = tcpd_ge %>% 
  mutate(decade = case_when(
    Year >= 1960 & Year < 1970 ~ 1,
    Year >= 1970 & Year < 1980 ~ 2,
    Year >= 1980 & Year < 1990 ~ 3,
    Year >= 1990 & Year < 2000 ~ 4,
    Year >= 2000 & Year < 2010 ~ 5,
    Year >= 2010 & Year < 2020 ~ 6,
    Year >= 2020 & Year < 2030 ~ 7,
    TRUE ~ NA_real_
  ))

```

# Turnout over the decades during Assembly Elections

```{r assembly turnout, include=FALSE}
tcpd_assembly_turnout_summary = tcpd_assembly %>%
  filter (Poll_No==0)%>%
  group_by(decade)%>%
  summarise(turnout=mean(Turnout_Percentage,na.rm=T)) %>% 
  mutate (Election_Type = "Assembly Elections")
```


```{r assembly turnout table, echo=FALSE, warning=FALSE}
#Use Echo option inside an R code chunk to hide the code while displaying the table.
tcpd_assembly_turnout_summary%>% 
  kable()
```

# Turnout over the decades during General Elections

```{r general election turnout, include=FALSE}
tcpd_ge_turnout_summary = tcpd_ge %>% 
  filter(Poll_No==0)%>%
  group_by(decade)%>%
  summarise(turnout=mean(Turnout_Percentage,na.rm=T)) %>% 
  mutate (Election_Type = "General Elections")
```


```{r general election turnout table, echo=FALSE}
tcpd_ge_turnout_summary%>% 
  kable()
```

# Comparing the General Election and Assembly Election Turnout over the decades 


```{r plotting, echo=FALSE, message=FALSE, warning=FALSE}

#warning = False so that warning message is not displayed in the knitted HTML

combined_turnout = bind_rows(tcpd_assembly_turnout_summary, tcpd_ge_turnout_summary) 

ggplot(combined_turnout, aes(x = decade, y = turnout, color = Election_Type, group = Election_Type)) +
  geom_line(size = 1) +       # Line plot
  geom_point(size = 3) +      # Add points for clarity
  labs(title = "Voter Turnout Trends by Decade",
       x = "Decade",
       y = "Average Turnout (%)",
       color = "Election Type") +
  theme_minimal() +
  scale_x_continuous(breaks = 1:7, labels = c("1960s", "1970s", "1980s", "1990s", "2000s", "2010s", "2020s")) +
  scale_color_manual(values = c("Assembly Elections" = "red", "General Elections" = "blue"))
```

- Assembly elections focus on state-level governance, which has a direct impact on people's daily lives (e.g., water supply, roads, education, jobs, law & order).  
- Voters feel more connected to state politics than national politics? 

# Turnout over the decades during Assembly Elections in **Delhi**

```{r ge turnout over decades in Delhi, warning=FALSE, include=FALSE}
tcpd_assembly_turnout_summary_delhi = tcpd_assembly %>% 
  filter(Poll_No==0 & State_Name =="Delhi")%>%
  group_by(decade)%>%
  summarise(turnout=mean(Turnout_Percentage,na.rm=T)) %>% 
  mutate (Election_Type = "Assembly Elections")
```


```{r ge turnout over decades in Delhi table, echo=FALSE}
tcpd_assembly_turnout_summary_delhi%>% 
  kable()
```


# Turnout over the decades during General Elections in **Delhi**

```{r ae turnout over decades in Delhi, include=FALSE}
tcpd_general_turnout_summary_delhi = tcpd_ge %>% 
  filter(Poll_No==0 & State_Name =="Delhi")%>%
  group_by(decade)%>%
  summarise(turnout=mean(Turnout_Percentage,na.rm=T)) %>% 
  mutate (Election_Type = "General Elections")
```


```{r ae turnout over decades in Delhi table, echo=FALSE}
tcpd_general_turnout_summary_delhi%>% 
  kable()
```

# Comparing the General Election and Assembly Election Turnout over the decades in **Delhi**

```{r plotting in Delhi, echo=FALSE, warning=FALSE}
combined_turnout_in_delhi= bind_rows(tcpd_assembly_turnout_summary_delhi, tcpd_general_turnout_summary_delhi) 

# Plot the turnout trends in Delhi

ggplot(combined_turnout_in_delhi, aes(x = decade, y = turnout, color = Election_Type, group = Election_Type)) +
  geom_line(size = 1) +       # Line plot
  geom_point(size = 3) +      # Add points for clarity
  labs(title = "Voter Turnout Trends by Decade (Delhi)",
       x = "Decade",
       y = "Average Turnout (%)",
       color = "Election Type") +
  theme_minimal() +
  scale_x_continuous(breaks = 1:7, labels = c("1960s", "1970s", "1980s", "1990s", "2000s", "2010s", "2020s")) +
  scale_color_manual(values = c("Assembly Elections" = "red", "General Elections" = "blue"))

```



